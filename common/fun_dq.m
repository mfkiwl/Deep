function dq = fun_dq(q, w)
% 四元数微分方程
% q:四元数,行向量
% w:角速度,rad/s

dq = 0.5*q*[ 0,    w(1),  w(2),  w(3);
           -w(1),   0,   -w(3),  w(2);
           -w(2),  w(3),   0,   -w(1);
           -w(3), -w(2),  w(1),   0 ];

end